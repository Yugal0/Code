<!DOCTYPE html>
<html>
<head>
    <title>Exponential Curve Fitting</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/regression@1.4.0/regression.min.js"></script>
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <h1>Exponential Curve Fitting</h1>
    <div id="chart-container">
        <!-- Your chart will be displayed here -->
    </div>

    <form id="data-form">
        <label for="x">X Value:</label>
        <input type="number" id="x" step="0.01" required>
        <label for="y">Y Value:</label>
        <input type="number" id="y" step="0.01" required>
        <button type="button" onclick="addDataPoint()">Add Data Point</button>
    </form>

    <button onclick="fitExponentialCurve()">Fit Exponential Curve</button>

    <script>
        const data = [];
        const svg = d3.select("#chart-container")
            .append("svg")
            .attr("width", 500)
            .attr("height", 300);

        const xScale = d3.scaleLinear()
            .range([0, 500]);

        const yScale = d3.scaleLinear()
            .range([300, 0]);

        function addDataPoint() {
            const x = parseFloat(document.getElementById("x").value);
            const y = parseFloat(document.getElementById("y").value);
            if (!isNaN(x) && !isNaN(y)) {
                data.push([x, y]);
                updateChart();
                document.getElementById("data-form").reset();
            }
        }

        function fitExponentialCurve() {
            const result = regression.exponential(data);
            const line = d3.line()
                .x(d => xScale(d[0]))
                .y(d => yScale(result.points.find(point => point[0] === d[0])[1]));

            svg.append("path")
                .datum(data)
                .attr("d", line)
                .attr("class", "curve");

            // Add curve equation or other info if needed

            // Print the fitted parameters (a, b) for the exponential equation
            console.log("Fitted Parameters (a, b):", result.equation);

        }

        function updateChart() {
            xScale.domain([0, d3.max(data, d => d[0])]);
            yScale.domain([0, d3.max(data, d => d[1])]);

            svg.selectAll("*").remove();

            svg.selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", d => xScale(d[0]))
                .attr("cy", d => yScale(d[1]))
                .attr("r", 5);
        }
    </script>
</body>
</html>
